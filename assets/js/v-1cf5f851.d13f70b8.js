(self.webpackChunkzcomposition=self.webpackChunkzcomposition||[]).push([[416],{3780:(e,n,t)=>{"use strict";t.r(n),t.d(n,{data:()=>a});const a={key:"v-1cf5f851",path:"/composition/useDownloader/",title:"useDownloader",lang:"en-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"代码演示",slug:"代码演示",children:[{level:3,title:"基础使用",slug:"基础使用",children:[]}]},{level:2,title:"示例代码",slug:"示例代码",children:[{level:3,title:"参数",slug:"参数",children:[]}]}],filePathRelative:"composition/useDownloader/README.md",git:{updatedTime:1631780821e3,contributors:[{name:"yinzhenyu-su",email:"sharkrain@outlook.com",commits:1}]}}},6237:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>k});var a=t(6252),o=t(9669),l=t.n(o);t(6486);var s=t(3162),i=t(2262);const r=(0,a._)("h1",{id:"usedownloader",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#usedownloader","aria-hidden":"true"},"#"),(0,a.Uk)(" useDownloader")],-1),c=(0,a._)("p",null,"文件下载器",-1),u=(0,a._)("h2",{id:"代码演示",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#代码演示","aria-hidden":"true"},"#"),(0,a.Uk)(" 代码演示")],-1),d=(0,a._)("h3",{id:"基础使用",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#基础使用","aria-hidden":"true"},"#"),(0,a.Uk)(" 基础使用")],-1),p=(0,a._)("h2",{id:"示例代码",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#示例代码","aria-hidden":"true"},"#"),(0,a.Uk)(" 示例代码")],-1),_=(0,a._)("div",{class:"language-typescript ext-ts line-numbers-mode"},[(0,a._)("pre",{class:"language-typescript"},[(0,a._)("code",null,[(0,a._)("span",{class:"token keyword"},"import"),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},"{"),(0,a.Uk)(" useDownloader "),(0,a._)("span",{class:"token punctuation"},"}"),(0,a.Uk)(),(0,a._)("span",{class:"token keyword"},"from"),(0,a.Uk)(),(0,a._)("span",{class:"token string"},'"zcomposition"'),(0,a._)("span",{class:"token punctuation"},";"),(0,a.Uk)("\n\n"),(0,a._)("span",{class:"token keyword"},"const"),(0,a.Uk)(),(0,a._)("span",{class:"token function-variable function"},"handleDownload"),(0,a.Uk)(),(0,a._)("span",{class:"token operator"},"="),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},"("),(0,a._)("span",{class:"token punctuation"},")"),(0,a.Uk)(),(0,a._)("span",{class:"token operator"},"=>"),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},"{"),(0,a.Uk)("\n  "),(0,a._)("span",{class:"token comment"},"// 默认会从url中提取文件名"),(0,a.Uk)("\n  "),(0,a._)("span",{class:"token function"},"useDownloader"),(0,a._)("span",{class:"token punctuation"},"("),(0,a._)("span",{class:"token punctuation"},"{"),(0,a.Uk)("url"),(0,a._)("span",{class:"token operator"},":"),(0,a.Uk)(),(0,a._)("span",{class:"token string"},'"https://file-examples-com.github.io/uploads/2018/04/file_example_AVI_480_750kB.avi"'),(0,a._)("span",{class:"token punctuation"},"}"),(0,a._)("span",{class:"token punctuation"},")"),(0,a.Uk)("\n"),(0,a._)("span",{class:"token punctuation"},"}"),(0,a.Uk)("\n")])]),(0,a._)("div",{class:"line-numbers"},[(0,a._)("span",{class:"line-number"},"1"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"2"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"3"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"4"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"5"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"6"),(0,a._)("br")])],-1),f=(0,a._)("h3",{id:"参数",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#参数","aria-hidden":"true"},"#"),(0,a.Uk)(" 参数")],-1),h=(0,a._)("table",null,[(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"参数"),(0,a._)("th",null,"说明"),(0,a._)("th",null,"类型"),(0,a._)("th",null,"默认值")])]),(0,a._)("tbody",null,[(0,a._)("tr",null,[(0,a._)("td",null,"url"),(0,a._)("td",null,"文件链接"),(0,a._)("td",null,[(0,a._)("code",null,"string")]),(0,a._)("td",null,"-")]),(0,a._)("tr",null,[(0,a._)("td",null,"filename"),(0,a._)("td",null,"要保存的文件名"),(0,a._)("td",null,[(0,a._)("code",null,"string")]),(0,a._)("td",null,"-")])])],-1),k=(0,a.aZ)({setup(e){const n=()=>{(({url:e="",filename:n=""})=>{const t=e.split("/"),a=n||t[t.length-1],o=(0,i.qj)({downloading:!1,request:{}});o.request=new Promise(((n,t)=>{o.downloading=!0,l().get(e,{responseType:"blob"}).then((e=>{(0,s.saveAs)(e.data,a),n(e.data)})).catch((e=>{t(e)})).finally((()=>{o.downloading=!1}))}))})({url:"https://file-examples-com.github.io/uploads/2018/04/file_example_AVI_480_750kB.avi"})};return(e,t)=>((0,a.wg)(),(0,a.iD)(a.HY,null,[r,c,u,d,(0,a._)("p",null,[(0,a._)("button",{onClick:n},"点击下载文件")]),p,_,f,h],64))}})},3162:function(e,n){var t;void 0===(t=function(){"use strict";function n(e,n,t){var a=new XMLHttpRequest;a.open("GET",e),a.responseType="blob",a.onload=function(){s(a.response,n,t)},a.onerror=function(){console.error("could not download file")},a.send()}function t(e){var n=new XMLHttpRequest;n.open("HEAD",e,!1);try{n.send()}catch(e){}return 200<=n.status&&299>=n.status}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(t){var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(n)}}var o="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,l=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=o.saveAs||("object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(e,l,s){var i=o.URL||o.webkitURL,r=document.createElement("a");l=l||e.name||"download",r.download=l,r.rel="noopener","string"==typeof e?(r.href=e,r.origin===location.origin?a(r):t(r.href)?n(e,l,s):a(r,r.target="_blank")):(r.href=i.createObjectURL(e),setTimeout((function(){i.revokeObjectURL(r.href)}),4e4),setTimeout((function(){a(r)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,o,l){if(o=o||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,n){return void 0===n?n={autoBom:!1}:"object"!=typeof n&&(console.warn("Deprecated: Expected third argument to be a object"),n={autoBom:!n}),n.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,l),o);else if(t(e))n(e,o,l);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout((function(){a(s)}))}}:function(e,t,a,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),"string"==typeof e)return n(e,t,a);var i="application/octet-stream"===e.type,r=/constructor/i.test(o.HTMLElement)||o.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||i&&r||l)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=e:location=e,s=null},u.readAsDataURL(e)}else{var d=o.URL||o.webkitURL,p=d.createObjectURL(e);s?s.location=p:location.href=p,s=null,setTimeout((function(){d.revokeObjectURL(p)}),4e4)}});o.saveAs=s.saveAs=s,e.exports=s}.apply(n,[]))||(e.exports=t)}}]);